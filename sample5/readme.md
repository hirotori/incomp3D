# sample5 : turbulent channel flow
平行平板間乱流をLESで計算する.

# 目的
LESのテスト.
あらかじめ用意したcaseクラスなどを用いず, パーツを組み合わせてプログラムを実行出来るかテスト.

# 概要
計算領域は, $x, y, z$ 方向にそれぞれ $6.2\delta \times 3.2\delta \times 2\delta$ の直方体領域とする. 壁面に垂直な方向を $z$ としている. ただし $\delta$ はチャネル幅の半分である. 

空間格子は不等間隔格子とし, $\tanh$ 関数を用いて[1]壁にメッシュを寄せている. 

代表パラメータはチャネル幅の半分 $\delta$ , 摩擦速度 $u_{\tau}$ , 動粘性係数 $\nu$ であり, レイノルズ数は $Re_{\tau} = 395$ としている.

初期条件は線形則と対数則の分布に, DNSで計算されたチャネル乱流の変動強度に一様乱数を乗じたものを加えた. なおデータについてはJAXAのDNSデータベース[2]を使用.

LESモデルは0方程式モデルで最も代表的なSmagorinskyモデルを適用している. 

# 注意
## 計算設定
メッシュは `mesh` フォルダ内の `meshgen.f90` で作成します. デフォルトでは [1]内のパラメータ通りで, $x, y, z$ 方向にそれぞれセルが $32, 64, 64$ 個配置されるようになっています. また, 前述の通り壁面に垂直な方向が慣例と異なり $z$ となっています. これが気に入らない場合は 変数 `swap_` を `.true.` とすれば慣例通り壁面垂直方向が $y$ となります.

ほかの $Re_{\tau}$ で計算したい場合はそれに合った初期条件を設定すれば良いです.

## 計算スキーム

移流項は2次精度中心差分としています. ただしメッシュの疎密にかかわらず単純な算術平均で評価しています. 

SmagorinskyモデルのSmagorinsky定数は $C_{s} = 0.065$ としています. 

時間精度について, 分子粘性項はクランク･ニコルソン法ですが, 移流項と渦粘性項はEuler陽解法となっています. 

計算スキームの変更については `les_solver.f90` を変更すれば良いです.


# 参考文献

[1] Moin P, Reynolds WC, Ferziger JH (1978) Large eddy simulation of incompressible turbulent channel flow

[2] https://jaxa-dns-database.jaxa.jp/channelflow.html (ch395.dat)